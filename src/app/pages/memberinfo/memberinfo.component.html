<div class="row">

  <!-- Member Entry Form -->
  <div class="col-lg-4">
    <div class="card mb-4">
      <div class="card-header py-3">
        <h3 class="m-0 font-weight-bold text-primary">Member Entry Form</h3>
      </div>
      <div class="card-body">
        <form #memberForm="ngForm" (ngSubmit)="saveMember()">

          <div class="row mb-3">

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Given Name</label>
              <input type="text" class="form-control" name="givenName" [(ngModel)]="savemem.givenName"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Sure Name</label>
              <input type="text" class="form-control" name="sureName" [(ngModel)]="savemem.sureName"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Phone</label>
              <input type="text" class="form-control" name="phone" [(ngModel)]="savemem.phone"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Email</label>
              <input type="text" class="form-control" name="email" [(ngModel)]="savemem.email"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">NID</label>
              <input type="text" class="form-control" name="NiD" [(ngModel)]="savemem.NiD"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Birth C-No</label>
              <input type="text" class="form-control" name="BiCNo" [(ngModel)]="savemem.BiCNo"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Passport No</label>
              <input type="text" class="form-control" name="passportNo" [(ngModel)]="savemem.passportNo"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Nationality</label>
              <input type="text" class="form-control" name="nationality" [(ngModel)]="savemem.nationality"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Father</label>
              <input type="text" class="form-control" name="father" [(ngModel)]="savemem.father"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Mother</label>
              <input type="text" class="form-control" name="mother" [(ngModel)]="savemem.mother"/>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Gender</label>
              <select class="form-control" name="Gender" [(ngModel)]="savemem.gender">
                <option *ngFor="let m of gen" [value]="m.id">{{m.genders}}</option>
              </select>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Address</label>
              <textarea class="form-control" name="address" [(ngModel)]="savemem.address"></textarea>
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Photo</label>
              <input type="file" class="form-control" (change)="onPhotoSelected($event)">
            </div>

            <div class="col-md-6">
              <label class="font-weight-bold text-secondary">Identity Document</label>
              <input type="file" class="form-control" (change)="onIdenSelected($event)">
            </div>

          </div>

          <button type="submit" class="btn btn-primary">Save Member</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Current Active Members -->
  <div class="col-lg-8">
   <div class="card">
  <div class="card-header py-3 d-flex justify-content-between align-items-center">
    <h3 class="m-0 font-weight-bold text-primary">Current Active Members</h3>
    <div>
      <a [routerLink]="['/member/membertrns']" class="btn btn-info btn-sm me-2">
        <i class="fas fa-exchange-alt"></i> Member Transfer
      </a>
      <a [routerLink]="['/member/memberdeactive']" class="btn btn-warning btn-sm">
        <i class="fas fa-user-slash"></i> Member Deactive
      </a>
    </div>
  </div>

  <div class="card-body text-center overflow">
      <div class="mb-3 text-start">
      <input type="text" class="form-control w-25 d-inline-block" placeholder="Search Member No" [(ngModel)]="searchMemNo">
    </div>
    <table class="table table-bordered table-hover">
      <thead class="table-light">
        <tr>
          <th>Member No</th>
          <th>Full Name</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Photo</th>
          <th>Identity</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
          <tr *ngFor="let m of filteredMembers | paginate: { itemsPerPage: itemsPerPage, currentPage: page }">

          <td>{{m.memNo}}</td>
          <td>{{m.givenName}} {{m.sureName}}</td>
          <td>{{m.phone}}</td>
          <td>{{m.email}}</td>
          <td>
            <img [src]="apiBaseUrl + '/memberphoto?memno=' + m.memNo"
                 alt="User Photo" class="img-thumbnail" width="80"/>
          </td>
          <td>
            <a [href]="apiBaseUrl + '/memberdocument?memno=' + m.memNo" target="_blank">
              Download
            </a>
          </td>
          <td>
            <button type="button" class="btn btn-primary btn-icon-split me-2" (click)="openAddUserModal(m.memNo)">
              <span class="icon text-white-50"><i class="fas fa-eye"></i></span>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <pagination-controls
      (pageChange)="page = $event"
      previousLabel="Prev"
      nextLabel="Next">
    </pagination-controls>
  </div>
</div>

  </div>

</div>

<!-- Member Details Modal -->
<div *ngIf="showUserDetailsModal" class="modal fade show d-block" tabindex="-1">
  <div class="modal-dialog custom-width">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Member Info</h3>
        <button type="button" class="btn-close" (click)="closeAddUserModal()" aria-label="Close"></button>
      </div>
      <div class="modal-body" *ngIf="selectedUser">
        <button type="button" class="btn btn-primary mb-2" (click)="OpenMemberEditModel(selectedUser.memNo)">Edit Member Information</button>

        <div class="row">
          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Member No</th><th>Given Name</th><th>Sure Name</th></tr></thead>
              <tbody>
                <tr>
                  <td>{{selectedUser.memNo}}</td>
                  <td>{{selectedUser.givenName}}</td>
                  <td>{{selectedUser.sureName}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>NID</th><th>Passport</th><th>Birth C-No</th></tr></thead>
              <tbody>
                <tr>
                  <td>{{selectedUser.niD}}</td>
                  <td>{{selectedUser.passportNo}}</td>
                  <td>{{selectedUser.biCNo}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Father</th><th>Mother</th><th>Gender</th></tr></thead>
              <tbody>
                <tr>
                  <td>{{selectedUser.father}}</td>
                  <td>{{selectedUser.mother}}</td>
                  <td>{{selectedUser.gender}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Phone</th><th>Email</th><th>Nationality</th></tr></thead>
              <tbody>
                <tr>
                  <td>{{selectedUser.phone}}</td>
                  <td>{{selectedUser.email}}</td>
                  <td>{{selectedUser.nationality}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Identity Docu</th><th>Photo</th></tr></thead>
              <tbody>
                <tr>
                  <td><a [href]="docuPreview" target="_blank">Download Pdf</a></td>
                  <td><img [src]="photoPreview" alt="User Photo" class="img-thumbnail" width="200"/></td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeAddUserModal()">Close</button>
      </div>
    </div>
  </div>
</div>
<div *ngIf="showUserDetailsModal" class="modal-backdrop fade show"></div>

<!-- Edit Member Modal -->
<div *ngIf="MemberEditModel" class="modal fade show d-block" tabindex="-1">
  <div class="modal-dialog custom-width">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Edit Member Info</h3>
        <button type="button" class="btn-close" (click)="closeeditmodel()" aria-label="Close"></button>
      </div>
      <div class="modal-body" *ngIf="selectedUser">
        <div class="row">

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Member No</th><th>Given Name</th><th>Sure Name</th></tr></thead>
              <tbody>
                <tr>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.memNo" readonly/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.givenName"/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.sureName"/></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>NID</th><th>Passport</th><th>Birth C-No</th></tr></thead>
              <tbody>
                <tr>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.niD"/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.passportNo"/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.biCNo"/></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Father</th><th>Mother</th><th>Gender</th></tr></thead>
              <tbody>
                <tr>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.father"/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.mother"/></td>
                  <td>
                    <select class="form-control" [(ngModel)]="selectedUser.gender">
                      <option *ngFor="let g of gen" [value]="g.id">{{g.genders}}</option>
                    </select>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Phone</th><th>Email</th><th>Nationality</th></tr></thead>
              <tbody>
                <tr>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.phone"/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.email"/></td>
                  <td><input type="text" class="form-control" [(ngModel)]="selectedUser.nationality"/></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-md-6">
            <table class="table table-bordered">
              <thead><tr><th>Photo</th><th>Document</th></tr></thead>
              <tbody>
                <tr>
                  <td>
                    <img [src]="photoPreview" alt="Photo" class="img-thumbnail mb-2" width="100" height="100"/>
                    <input type="file" class="form-control" (change)="onPhotoSelected($event)"/>
                  </td>
                  <td>
                    <a [href]="docuPreview" target="_blank">Download</a>
                    <input type="file" class="form-control" (change)="onIdenSelected($event)"/>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="col-md-6">
  <button type="button" class="btn btn-success" (click)="saveMember()">Save Changes</button>

          </div>

        </div>
      </div>
      <div class="modal-footer">

        <button type="button" class="btn btn-secondary" (click)="closeeditmodel()">Close</button>
      </div>
    </div>
  </div>
</div>
<div *ngIf="MemberEditModel" class="modal-backdrop fade show"></div>
